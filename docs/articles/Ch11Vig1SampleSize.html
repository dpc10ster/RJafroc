<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 11, Vignette 1: Background on the F distribution â€¢ RJafroc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 11, Vignette 1: Background on the F distribution">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RJafroc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Ch00Vig1DataFormat.html">Chapter 00, Vignette 1: JAFROC data format</a>
    </li>
    <li>
      <a href="../articles/Ch10V1QuickStartDBMH.html">Chapter 10, Vignette 1: Quick Start: Running DBMH-ORH analysis</a>
    </li>
    <li>
      <a href="../articles/Ch10V2QuickStartDBMHExcel.html">Chapter 10, Vignette 2: Quick Start DBMH-ORH Analysis with Excel Output</a>
    </li>
    <li>
      <a href="../articles/Ch11Vig1SampleSize.html">Chapter 11, Vignette 1: Background on the F distribution</a>
    </li>
    <li>
      <a href="../articles/Ch11Vig2SampleSize.html">Chapter 11, Vignette 2: ROC-DBMH sample size from first principles</a>
    </li>
    <li>
      <a href="../articles/Ch11Vig3SampleSize.html">Chapter 11, Vignette 3: RJafroc functions for ROC sample size estimation using DBMH method</a>
    </li>
    <li>
      <a href="../articles/Ch11Vig4SampleSize.html">Chapter 11, Vignette 4: RJafroc functions for ROC sample size estimation using ORH method</a>
    </li>
    <li>
      <a href="../articles/Ch11Vig5SampleSize.html">Chapter 11, Vignette 5: On choosing a realistic effect size</a>
    </li>
    <li>
      <a href="../articles/Ch19Vig1FrocSampleSize.html">Chapter 19, Vignette 1: FROC sample size estimation and comparison to ROC</a>
    </li>
    <li>
      <a href="../articles/Ch20V1improperROCs.html">Chapter 20, Vignette 1: Improper ROCs</a>
    </li>
    <li>
      <a href="../articles/Ch20V2degenerateROCs.html">Chapter 20, Vignette 2: Degenerate datasets in the binormal model</a>
    </li>
    <li>
      <a href="../articles/Ch20V3proprocROCs.html">Chapter 20, Vignette 3: PROPROC ROCs and pdfs</a>
    </li>
    <li>
      <a href="../articles/Ch20V4metzEqn36.html">Chapter 20, Vignette 4: Metz Eqn36 numerical check</a>
    </li>
    <li>
      <a href="../articles/Ch20V5cbmPlots.html">Chapter 20, Vignette 5: CBM plots</a>
    </li>
    <li>
      <a href="../articles/Ch30V1RoiParadigm.html">Chapter 30, Vignette 1: Analyzing data acquired according to the ROI paradigm</a>
    </li>
    <li>
      <a href="../articles/Ch30V2RoiParadigmSt.html">Chapter 30, Vignette 2: Significance testing for the ROI paradigm</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Chapter 11, Vignette 1: Background on the F distribution</h1>
                        <h4 class="author">Dev P. Chakraborty</h4>
            
            <h4 class="date">2019-10-29</h4>
      
      
      <div class="hidden name"><code>Ch11Vig1SampleSize.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Since it plays such a central role in sample size estimation, it is helpful to examine the behavior of the F-distribution. In the following <code>ndf</code> = numerator degrees of freedom, <code>ddf</code> = denominator degrees of freedom and <code>ncp</code> = non-centrality parameter (i.e., the delta appearing in Eqn. (11.6)).</p>
<p>The use of three functions is demonstrated.</p>
<ul>
<li><p><code><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">qf(p,ndf,ddf)</a></code> is the <em>quantile</em> function of the F-distribution for specified values of <code>ndf</code> and <code>ddf</code>, i.e., the value <code>x</code> such that fraction <code>p</code> of the area under the F-distribution lies to the right of <code>x</code>. Since it is not included as a parameter, the default value, i.e., zero, of <code>ncp</code> is used. This is called the <em>central</em> F-distribution.</p></li>
<li><p><code><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">df(x,ndf,ddf,ncp)</a></code> is the <em>pdf</em> or probability density function of the F-distribution for specified values of <code>ndf</code>, <code>ddf</code> and <code>ncp</code>.</p></li>
<li><p><code><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">pf(x,ndf,ddf,ncp)</a></code> is the probability (or cumulative) distribution function of the F-distribution for specified values of <code>ndf</code>, <code>ddf</code> and <code>ncp</code>.</p></li>
</ul>
<p>In the following four values of <code>ncp</code> are considered 0, 2, 5, 10.</p>
</div>
<div id="illustrating-the-f-distribution-for-ndf-2-ddf-10" class="section level2">
<h2 class="hasAnchor">
<a href="#illustrating-the-f-distribution-for-ndf-2-ddf-10" class="anchor"></a>Illustrating the F-distribution for <code>ndf</code> = 2, <code>ddf</code> = 10</h2>
<p>In the following <code>fCrit</code> is the critical value of the F distribution, i.e., that value such that fraction <span class="math inline">\(\alpha\)</span> of the area is to the right of the critical value. It is usually denoted <span class="math inline">\({{F}_{1-\alpha ,ndf,ddf}}\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">ndf &lt;-<span class="st"> </span><span class="dv">2</span>;ddf &lt;-<span class="st"> </span><span class="dv">10</span>;ncp &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">fCrit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">qf</a></span>(<span class="fl">0.95</span>, ndf,ddf)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"critical value of x for rejecting NH is "</span>, fCrit,<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; critical value of x for rejecting NH is  4.102821</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">myLabel &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">myLabelIndx &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(ncp))</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">{</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">df</a></span>(x,ndf,ddf,<span class="dt">ncp=</span>ncp[i])</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"ndf = "</span>, ndf, <span class="st">", ddf = "</span>, ddf, <span class="st">", ncp = "</span>, ncp[i], <span class="st">", prob &gt; fCrit = "</span>, </a>
<a class="sourceLine" id="cb1-12" data-line-number="12">      <span class="dv">1</span><span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">pf</a></span>(fCrit, ndf, ddf, <span class="dt">ncp =</span> ncp[i]), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">}  </a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; ndf =  2 , ddf =  10 , ncp =  0 , prob &gt; fCrit =  0.05 </span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; ndf =  2 , ddf =  10 , ncp =  2 , prob &gt; fCrit =  0.177584 </span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; ndf =  2 , ddf =  10 , ncp =  5 , prob &gt; fCrit =  0.3876841 </span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt; ndf =  2 , ddf =  10 , ncp =  10 , prob &gt; fCrit =  0.6769776</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(ncp))</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">{</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">  y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">df</a></span>(x,ndf,ddf,<span class="dt">ncp=</span>ncp[i])</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">  curveData &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> x, <span class="dt">pdf =</span> y)</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">  curvePlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> curveData, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> pdf)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="st">    </span><span class="kw">ggtitle</span>(myLabel[myLabelIndx]);myLabelIndx &lt;-<span class="st"> </span>myLabelIndx <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(curvePlot)</a>
<a class="sourceLine" id="cb1-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb1-27" data-line-number="27">fCrit_<span class="dv">2</span>_<span class="dv">10</span> &lt;-<span class="st"> </span>fCrit</a></code></pre></div>
<p><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-1-1.png" width="700"><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-1-2.png" width="700"><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-1-3.png" width="700"><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-1-4.png" width="700"></p>
<div id="comments" class="section level3">
<h3 class="hasAnchor">
<a href="#comments" class="anchor"></a>Comments</h3>
<ol style="list-style-type: upper-alpha">
<li>Corresponds to <code>ncp = 0</code>, which yields the usual (aka <em>central</em>) F-distribution that was used in the previous two chapters (9 and 10). The integral under this distribution is unity (this is true for all plots above). The critical value, <code>fCrit</code> in the code, is that value of <code>x</code> such that the probability of exceeding <code>x</code> is <span class="math inline">\(\alpha\)</span>; in the current example <code>fCrit</code> = 4.102821. Notice the use of the quantile function <code><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">qf()</a></code> to determine this value, also that the default value of <code>ncp</code>, namely zero, is used; specifically, one does not pass a 4th argument to <code><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">qf()</a></code>. <strong>The decision rule for rejecting the NH uses the NH distribution of the F-statistic</strong>, i.e., reject the NH if F &gt;= <code>fCrit</code>. As expected, <code>prob &gt; fCrit</code> = 0.05 because this is how <code>fCrit</code> was defined.</li>
<li>Corresponds to <code>ncp = 2</code>. It is noticeably shifted to the right as compared to A, thereby making it more likely that the observed value of the F-statistic will exceed the critical value determined for the NH distribution. In fact, <code>prob &gt; fCrit</code> = 0.177584, which is the <em>statistical power</em>.</li>
<li>Corresponds to <code>ncp = 5</code>, and now <code>prob &gt; fCrit</code> = 0.3876841.</li>
<li>Corresponds to <code>ncp = 10</code>, and now <code>prob &gt; fCrit</code> is 0.6769776. The effect of the shift is obvious in plots (C) and (D). Considering a vertical line at <code>x = 4.10</code>, most of the distribution in plot (D), more than 0.6769776, to be precise, lies to the right of this line, so the NH is more than 0.6769776 likely to be rejected. Of course, what causes the shift is the increased value of the non-centrality parameter. The larger that non-centrality parameter, the greater the shift to the right.</li>
</ol>
</div>
</div>
<div id="illustrating-the-f-distribution-for-ndf-2-ddf-100" class="section level2">
<h2 class="hasAnchor">
<a href="#illustrating-the-f-distribution-for-ndf-2-ddf-100" class="anchor"></a>Illustrating the F-distribution for <code>ndf</code> = 2, <code>ddf</code> = 100</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">ndf &lt;-<span class="st"> </span><span class="dv">2</span>;ddf &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">fCrit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">qf</a></span>(<span class="fl">0.95</span>, ndf,ddf)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"critical value of x for rejecting NH is "</span>, fCrit,<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; critical value of x for rejecting NH is  3.087296</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">myLabel &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"H"</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">myLabelIndx &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(ncp))</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">{</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">df</a></span>(x,ndf,ddf,<span class="dt">ncp=</span>ncp[i])</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"ndf = "</span>, ndf, <span class="st">", ddf = "</span>, ddf, <span class="st">", ncp = "</span>, ncp[i], <span class="st">", prob &gt; fCrit = "</span>, </a>
<a class="sourceLine" id="cb2-12" data-line-number="12">      <span class="dv">1</span><span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">pf</a></span>(fCrit, ndf, ddf, <span class="dt">ncp =</span> ncp[i]), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">}  </a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; ndf =  2 , ddf =  100 , ncp =  0 , prob &gt; fCrit =  0.05 </span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; ndf =  2 , ddf =  100 , ncp =  2 , prob &gt; fCrit =  0.2199264 </span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; ndf =  2 , ddf =  100 , ncp =  5 , prob &gt; fCrit =  0.4910802 </span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; ndf =  2 , ddf =  100 , ncp =  10 , prob &gt; fCrit =  0.8029764</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(ncp))</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">{</a>
<a class="sourceLine" id="cb2-20" data-line-number="20">  y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">df</a></span>(x,ndf,ddf,<span class="dt">ncp=</span>ncp[i])</a>
<a class="sourceLine" id="cb2-21" data-line-number="21">  curveData &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> x, <span class="dt">pdf =</span> y)</a>
<a class="sourceLine" id="cb2-22" data-line-number="22">  curvePlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> curveData, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> pdf)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="st">    </span><span class="kw">ggtitle</span>(myLabel[myLabelIndx]);myLabelIndx &lt;-<span class="st"> </span>myLabelIndx <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(curvePlot)</a>
<a class="sourceLine" id="cb2-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">fCrit_<span class="dv">2</span>_<span class="dv">100</span> &lt;-<span class="st"> </span>fCrit</a></code></pre></div>
<p><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-2-1.png" width="700"><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-2-2.png" width="700"><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-2-3.png" width="700"><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-2-4.png" width="700"></p>
<div id="comments-1" class="section level3">
<h3 class="hasAnchor">
<a href="#comments-1" class="anchor"></a>Comments</h3>
<ol start="5" style="list-style-type: upper-alpha">
<li>Corresponds to <code>ncp = 0</code>. The critical value is <code>fCrit_2_100</code> = 3.0872959. Notice the decrease compared to the previous value, i.e., 4.102821, for ddf = 10.</li>
<li>Corresponds to <code>ncp = 2</code>, and <code>prob &gt; fCrit_2_100</code> = 0.2199264, greater than the previous value 0.177584.</li>
<li>Corresponds to <code>ncp = 5</code>, and now <code>prob &gt; fCrit_2_100</code> = 0.4910802.</li>
<li>Corresponds to <code>ncp = 10</code>, and now <code>prob &gt; fCrit_2_100</code> is 0.8029764.</li>
</ol>
</div>
</div>
<div id="illustrating-the-f-distribution-for-ndf-1-ddf-100" class="section level2">
<h2 class="hasAnchor">
<a href="#illustrating-the-f-distribution-for-ndf-1-ddf-100" class="anchor"></a>Illustrating the F-distribution for <code>ndf</code> = 1, <code>ddf</code> = 100</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">ndf &lt;-<span class="st"> </span><span class="dv">1</span>;ddf &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">fCrit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">qf</a></span>(<span class="fl">0.95</span>, ndf,ddf)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"critical value of x for rejecting NH is "</span>, fCrit,<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; critical value of x for rejecting NH is  3.936143</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">myLabel &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"I &lt;- "</span>, <span class="st">"J"</span>, <span class="st">"K"</span>, <span class="st">"L"</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(ncp))</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">{</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">df</a></span>(x,ndf,ddf,<span class="dt">ncp=</span>ncp[i])</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"ndf = "</span>, ndf, <span class="st">", ddf = "</span>, ddf, <span class="st">", ncp = "</span>, ncp[i], <span class="st">", prob &gt; fCrit = "</span>, </a>
<a class="sourceLine" id="cb3-11" data-line-number="11">      <span class="dv">1</span><span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">pf</a></span>(fCrit, ndf, ddf, <span class="dt">ncp =</span> ncp[i]), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">}  </a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; ndf =  1 , ddf =  100 , ncp =  0 , prob &gt; fCrit =  0.05 </span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; ndf =  1 , ddf =  100 , ncp =  2 , prob &gt; fCrit =  0.2883607 </span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; ndf =  1 , ddf =  100 , ncp =  5 , prob &gt; fCrit =  0.6004962 </span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; ndf =  1 , ddf =  100 , ncp =  10 , prob &gt; fCrit =  0.8793619</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17">myLabelIndx &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(ncp))</a>
<a class="sourceLine" id="cb3-19" data-line-number="19">{</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">  y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Fdist">df</a></span>(x,ndf,ddf,<span class="dt">ncp=</span>ncp[i])</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">  curveData &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> x, <span class="dt">pdf =</span> y)</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">  curvePlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> curveData, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> pdf)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="st">    </span><span class="kw">ggtitle</span>(myLabel[myLabelIndx]);myLabelIndx &lt;-<span class="st"> </span>myLabelIndx <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(curvePlot)</a>
<a class="sourceLine" id="cb3-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb3-27" data-line-number="27">fCrit_<span class="dv">1</span>_<span class="dv">100</span> &lt;-<span class="st"> </span>fCrit</a></code></pre></div>
<p><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-3-1.png" width="700"><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-3-2.png" width="700"><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-3-3.png" width="700"><img src="Ch11Vig1SampleSize_files/figure-html/unnamed-chunk-3-4.png" width="700"></p>
<div id="comments-2" class="section level3">
<h3 class="hasAnchor">
<a href="#comments-2" class="anchor"></a>Comments</h3>
<ol style="list-style-type: upper-roman">
<li>Corresponds to <code>ncp = 0</code>. The critical value is <code>fCrit_1_100</code> = 3.936143. Notice the increase compared to the corresponding value for <code>ndf = 2</code>, i.e., 3.0872959.</li>
</ol>
<ol start="10" style="list-style-type: upper-alpha">
<li>Corresponds to <code>ncp = 2</code>, and <code>prob &gt; fCrit_1_100</code> = 0.2883607, larger than the previous value 0.2199264.</li>
<li>Corresponds to <code>ncp = 5</code>, and now <code>prob &gt; fCrit_1_100</code> = 0.6004962, larger than the previous value 0.4910802.</li>
<li>Corresponds to <code>ncp = 10</code>, and now <code>prob &gt; fCrit_1_100</code> is 0.8793619, larger than the previous value 0.8029764.</li>
</ol>
</div>
</div>
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h2>
<p>Power increases with increasing <code>ddf</code> and <code>ncp</code>; the effect of increasing <code>ncp</code> is quite dramatic. Decreasing <code>ndf</code> also increases power. At first glance this may seem counterintuitive, as <code>fCrit</code> has gone up, but can be explained by the differing shapes of the two distributions: the pdf is broader for <code>ndf</code> = 1 as compared to <code>ndf</code> = 2 (compare plot L to H).</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#illustrating-the-f-distribution-for-ndf-2-ddf-10">Illustrating the F-distribution for <code>ndf</code> = 2, <code>ddf</code> = 10</a></li>
      <li><a href="#illustrating-the-f-distribution-for-ndf-2-ddf-100">Illustrating the F-distribution for <code>ndf</code> = 2, <code>ddf</code> = 100</a></li>
      <li><a href="#illustrating-the-f-distribution-for-ndf-1-ddf-100">Illustrating the F-distribution for <code>ndf</code> = 1, <code>ddf</code> = 100</a></li>
      <li><a href="#summary">Summary</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Dev Chakraborty, Peter Philips, Xuetong Zhai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
