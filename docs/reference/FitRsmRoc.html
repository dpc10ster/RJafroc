<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit the radiological search model (RSM) to ROC data — FitRsmRoc • RJafroc</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fit the radiological search model (RSM) to ROC data — FitRsmRoc" />

<meta property="og:description" content="Fit an RSM-predicted ROC curve to a binned ROC dataset" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RJafroc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Ch00V1DataFormat.html">Chapter 00, Vignette 1: JAFROC data format</a>
    </li>
    <li>
      <a href="../articles/Ch10V1QuickStartDBMH.html">Chapter 10, Vignette 1: Quick Start: Running DBMH-ORH analysis</a>
    </li>
    <li>
      <a href="../articles/Ch10V2QuickStartDBMHExcel.html">Chapter 10, Vignette 2: Quick Start DBMH-ORH Analysis with Excel Output</a>
    </li>
    <li>
      <a href="../articles/Ch11V1SampleSize.html">Chapter 11, Vignette 1: Background on the F distribution</a>
    </li>
    <li>
      <a href="../articles/Ch11V2SampleSize.html">Chapter 11, Vignette 2: ROC-DBMH sample size from first principles</a>
    </li>
    <li>
      <a href="../articles/Ch11V3SampleSize.html">Chapter 11, Vignette 3: RJafroc functions for ROC sample size estimation using DBMH method</a>
    </li>
    <li>
      <a href="../articles/Ch11V4SampleSize.html">Chapter 11, Vignette 4: RJafroc functions for ROC sample size estimation using ORH method</a>
    </li>
    <li>
      <a href="../articles/Ch11V5SampleSize.html">Chapter 11, Vignette 5: On choosing a realistic effect size</a>
    </li>
    <li>
      <a href="../articles/Ch20V1improperROCs.html">Chapter 20, Vignette 1: Improper ROCs</a>
    </li>
    <li>
      <a href="../articles/Ch20V2degenerateROCs.html">Chapter 20, Vignette 2: Degenerate datasets in the binormal model</a>
    </li>
    <li>
      <a href="../articles/Ch20V3proprocROCs.html">Chapter 20, Vignette 3: PROPROC ROCs and pdfs</a>
    </li>
    <li>
      <a href="../articles/Ch20V4metzEqn36.html">Chapter 20, Vignette 4: Metz Eqn36 numerical check</a>
    </li>
    <li>
      <a href="../articles/Ch20V5cbmPlots.html">Chapter 20, Vignette 5: CBM plots</a>
    </li>
    <li>
      <a href="../articles/Ch30V1RoiParadigm.html">Chapter 30, Vignette 1: Analyzing data acquired according to the ROI paradigm</a>
    </li>
    <li>
      <a href="../articles/Ch30V2RoiParadigmSt.html">Chapter 30, Vignette 2: Significance testing for the ROI paradigm</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit the radiological search model (RSM) to ROC data</h1>
    
    <div class="hidden name"><code>FitRsmRoc.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Fit an RSM-predicted ROC curve to a binned ROC dataset</p>
    
    </div>

    <pre class="usage"><span class='fu'>FitRsmRoc</span>(<span class='no'>binnedRocData</span>, <span class='no'>lesDistr</span>, <span class='kw'>trt</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>rdr</span> <span class='kw'>=</span> <span class='fl'>1</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>binnedRocData</th>
      <td><p>The <strong>binned ROC</strong> dataset containing the data</p></td>
    </tr>
    <tr>
      <th>lesDistr</th>
      <td><p>The lesion distribution matrix</p></td>
    </tr>
    <tr>
      <th>trt</th>
      <td><p>The desired treatment, default is 1</p></td>
    </tr>
    <tr>
      <th>rdr</th>
      <td><p>The desired reader, default is 1</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The return value is a list with the following elements:</p>
<dt>mu</dt><dd><p>The mean of the diseased distribution relative 
   to the non-diseased one</p></dd>

<dt>lambdP</dt><dd><p>The Poisson parameter describing the distribution 
   of latent NLs per case</p></dd>

<dt>nuP</dt><dd><p>The binomial success probability describing the distribution
   of latent LLs per diseased case</p></dd>

<dt>zetas</dt><dd><p>The RSM cutoffs, zetas or thresholds</p></dd>

<dt>AUC</dt><dd><p>The RSM fitted ROC-AUC</p></dd>

<dt>StdAUC</dt><dd><p>The standard deviation of AUC</p></dd>

<dt>NLLIni</dt><dd><p>The initial value of negative LL</p></dd>

<dt>NLLFin</dt><dd><p>The final value of negative LL</p></dd>

<dt>ChisqrFitStats</dt><dd><p>The chisquare goodness of fit results</p></dd>

<dt>covMat</dt><dd><p>The covariance matrix of the parameters</p></dd>

<dt>fittedPlot</dt><dd><p>A <span class="pkg">ggplot2</span> object containing the fitted 
   operating characteristic along with the empirical operating points. 
   Use <code>print</code> to display the object</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If dataset is FROC, first convert it to ROC, using <code><a href='DfFroc2Roc.html'>DfFroc2Roc</a></code>. MLE ROC algorithms 
   require binned datasets. Use <code><a href='DfBinDataset.html'>DfBinDataset</a></code> to perform the binning prior to calling 
   this function. 
   In the RSM: (1) The (random) number of latent NLs per case is Poisson distributed 
   with mean parameter lambdaP, and the corresponding ratings are sampled from 
   \(N(0,1)\). The (2) The (random) number of latent LLs per diseased case is 
   binomial distributed with success probability nuP and trial size equal to 
   the number of lesions in the case, and the corresponding ratings are sampled from 
   N(\(mu\),1). (3) A latent NL or LL is actually marked if its rating exceeds 
   the lowest threshold zeta1. To avoid clutter error bars are only shown for the 
   lowest and uppermost operating points. Because of the extra parameter, and the 
   requirement to have five counts, the chi-square statistic often cannot be calculated.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chakraborty DP (2006) A search model and figure of merit for observer data acquired according to the free-response 
paradigm. Phys Med Biol 51, 3449-3462.</p>
<p>Chakraborty DP (2006) ROC Curves predicted by a model of visual search. Phys Med Biol 51, 3463--3482.</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href='https://www.crcpress.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840'>https://www.crcpress.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Test with included ROC data (some bins have zero counts)</span>
<span class='no'>lesDistr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='UtilLesionDistribution.html'>UtilLesionDistribution</a></span>(<span class='no'>dataset02</span>)
<span class='no'>retFit</span> <span class='kw'>&lt;-</span> <span class='fu'>FitRsmRoc</span>(<span class='no'>dataset02</span>, <span class='no'>lesDistr</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>retFit</span>$<span class='no'>fittedPlot</span>)</div><div class='img'><img src='FitRsmRoc-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Test with included degenerate ROC data</span>
<span class='no'>lesDistr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='UtilLesionDistribution.html'>UtilLesionDistribution</a></span>(<span class='no'>datasetDegenerate</span>)
<span class='no'>retFit</span> <span class='kw'>&lt;-</span> <span class='fu'>FitRsmRoc</span>(<span class='no'>datasetDegenerate</span>, <span class='no'>lesDistr</span>);<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>retFit</span>$<span class='no'>fittedPlot</span>)</div><div class='img'><img src='FitRsmRoc-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Test with single interior point data</span>
<span class='no'>fp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>7</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>2</span>, <span class='fl'>3</span>))
<span class='no'>tp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>5</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>2</span>, <span class='fl'>5</span>))
<span class='no'>binnedRocData</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Df2RJafrocDataset.html'>Df2RJafrocDataset</a></span>(<span class='no'>fp</span>, <span class='no'>tp</span>)
<span class='no'>lesDistr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='UtilLesionDistribution.html'>UtilLesionDistribution</a></span>(<span class='no'>binnedRocData</span>)
<span class='no'>retFit</span> <span class='kw'>&lt;-</span> <span class='fu'>FitRsmRoc</span>(<span class='no'>binnedRocData</span>, <span class='no'>lesDistr</span>);<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>retFit</span>$<span class='no'>fittedPlot</span>)</div><div class='img'><img src='FitRsmRoc-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Test with two interior data points</span>
<span class='no'>fp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>7</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>2</span>, <span class='fl'>5</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>3</span>, <span class='fl'>3</span>))
<span class='no'>tp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>3</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>2</span>, <span class='fl'>5</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>3</span>, <span class='fl'>7</span>))
<span class='no'>binnedRocData</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Df2RJafrocDataset.html'>Df2RJafrocDataset</a></span>(<span class='no'>fp</span>, <span class='no'>tp</span>)
<span class='no'>lesDistr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='UtilLesionDistribution.html'>UtilLesionDistribution</a></span>(<span class='no'>binnedRocData</span>)
<span class='no'>retFit</span> <span class='kw'>&lt;-</span> <span class='fu'>FitRsmRoc</span>(<span class='no'>binnedRocData</span>, <span class='no'>lesDistr</span>);<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>retFit</span>$<span class='no'>fittedPlot</span>)</div><div class='img'><img src='FitRsmRoc-4.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>## Test with three interior data points</span>
<span class='no'>fp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>12</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>2</span>, <span class='fl'>5</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>3</span>, <span class='fl'>3</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>4</span>, <span class='fl'>5</span>)) <span class='co'>#25</span>
<span class='no'>tp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>3</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>2</span>, <span class='fl'>5</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>3</span>, <span class='fl'>7</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>4</span>, <span class='fl'>10</span>)) <span class='co'>#25</span>
<span class='no'>binnedRocData</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Df2RJafrocDataset.html'>Df2RJafrocDataset</a></span>(<span class='no'>fp</span>, <span class='no'>tp</span>)
<span class='no'>lesDistr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='UtilLesionDistribution.html'>UtilLesionDistribution</a></span>(<span class='no'>binnedRocData</span>)
<span class='no'>retFit</span> <span class='kw'>&lt;-</span> <span class='fu'>FitRsmRoc</span>(<span class='no'>binnedRocData</span>, <span class='no'>lesDistr</span>);<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>retFit</span>$<span class='no'>fittedPlot</span>)</div><div class='img'><img src='FitRsmRoc-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## test for TONY data, i = 2 and j = 3; only case permitting chisqure calculation</span>
<span class='no'>lesDistr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='UtilLesionDistribution.html'>UtilLesionDistribution</a></span>(<span class='no'>dataset01</span>)
<span class='no'>rocData</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='DfFroc2Roc.html'>DfFroc2Roc</a></span>(<span class='no'>dataset01</span>)
<span class='no'>retFit</span> <span class='kw'>&lt;-</span> <span class='fu'>FitRsmRoc</span>(<span class='no'>rocData</span>, <span class='no'>lesDistr</span>, <span class='kw'>trt</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>rdr</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>retFit</span>$<span class='no'>fittedPlot</span>)</div><div class='img'><img src='FitRsmRoc-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>retFit</span>$<span class='no'>ChisqrFitStats</span></div><div class='output co'>#&gt; $chisq
#&gt; [1] 1.352244
#&gt; 
#&gt; $pVal
#&gt; [1] 0.2448863
#&gt; 
#&gt; $df
#&gt; [1] 1
#&gt; </div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Dev Chakraborty, Xuetong Zhai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

