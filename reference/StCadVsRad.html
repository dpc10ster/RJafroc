<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Significance testing: standalone CAD vs. radiologists — StCadVsRad • RJafroc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Significance testing: standalone CAD vs. radiologists — StCadVsRad"><meta property="og:description" content="Comparing standalone CAD vs. at least two radiologists interpreting
   the same cases; standalone CAD means that all the
   designer-level mark-rating pairs generated by the CAD algorithm
   are available to the analyst, not just the one or two marks per case
   displayed to the radiologist (the latter are marks whose ratings exceed a
   pre-selected threshold). At the very minimum, location-level information,
   such as in
   the LROC paradigm, should be used. Ideally, the FROC paradigm should be used.
   A severe statistical power penalty is paid if one uses the ROC paradigm.
   See Standalone CAD vs Radiologists chapter, available via download
   link at site
   https://github.com/dpc10ster/RJafrocBook/blob/gh-pages/RJafrocBook.pdf"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RJafroc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Significance testing: standalone CAD vs. radiologists</h1>

    <div class="hidden name"><code>StCadVsRad.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Comparing standalone CAD vs. at least two radiologists interpreting
   the same cases; <strong>standalone CAD</strong> means that <b>all</b> the
   <b>designer-level</b> mark-rating pairs generated by the CAD algorithm
   are available to the analyst, not just the one or two marks per case
   displayed to the radiologist (the latter are marks whose ratings exceed a
   pre-selected threshold). At the very minimum, location-level information,
   such as in
   the LROC paradigm, should be used. Ideally, the FROC paradigm should be used.
   A severe statistical power penalty is paid if one uses the ROC paradigm.
   See Standalone CAD vs Radiologists chapter, available via <em>download</em>
   link at site
   <a href="https://github.com/dpc10ster/RJafrocBook/blob/gh-pages/RJafrocBook.pdf" class="external-link">https://github.com/dpc10ster/RJafrocBook/blob/gh-pages/RJafrocBook.pdf</a></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">StCadVsRad</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">FOM</span>,</span>
<span>  FPFValue <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"1T-RRRC"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  plots <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p><strong>The dataset to be analyzed; must be single-modality
at least three readers, where the first reader is CAD. </strong></p></dd>


<dt id="arg-fom">FOM<a class="anchor" aria-label="anchor" href="#arg-fom"></a></dt>
<dd><p>The desired FOM; for ROC data it must be <code>"Wilcoxon"</code>, for FROC data
it can be any valid FOM, e.g., <code>"HrAuc"</code>, <code>"wAFROC"</code>, etc;
for LROC data it must be <code>"Wilcoxon"</code>, or <code>"PCL"</code> or <code>"ALROC"</code>.</p></dd>


<dt id="arg-fpfvalue">FPFValue<a class="anchor" aria-label="anchor" href="#arg-fpfvalue"></a></dt>
<dd><p>Only needed for <code>LROC</code> data <strong>and</strong> FOM = "PCL" or "ALROC";
where to evaluate a partial curve based figure of merit. The default is 0.2.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The desired analysis: "1T-RRFC","1T-RRRC" (the default) or "2T-RRRC",
see manuscript for details.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance level of the test, defaults to 0.05.</p></dd>


<dt id="arg-plots">plots<a class="anchor" aria-label="anchor" href="#arg-plots"></a></dt>
<dd><p>Flag, default is FALSE, i.e., a plot is not displayed.
If TRUE, it displays the appropriate operating characteristic for all
readers and CAD.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If <code>method = "1T-RRRC"</code> the return value is a
   list with the following elements:</p>
<dl><dt>fomCAD</dt>
<dd><p>The observed FOM for CAD.</p></dd>


<dt>fomRAD</dt>
<dd><p>The observed FOM array for the readers.</p></dd>


<dt>avgRadFom</dt>
<dd><p>The average FOM of the readers.</p></dd>


<dt>avgDiffFom</dt>
<dd><p>The mean of the difference FOM, RAD - CAD.</p></dd>


<dt>ciAvgDiffFom</dt>
<dd><p>The 95-percent CI of the average difference, RAD - CAD.</p></dd>


<dt>varR</dt>
<dd><p>The variance of the radiologists.</p></dd>


<dt>varError</dt>
<dd><p>The variance of the error term in the single-modality
   multiple-reader OR model.</p></dd>


<dt>cov2</dt>
<dd><p>The covariance of the error term.</p></dd>


<dt>tstat</dt>
<dd><p>The observed value of the t-statistic; it's square is
   equivalent to an F-statistic.</p></dd>


<dt>df</dt>
<dd><p>The degrees of freedom of the t-statistic.</p></dd>


<dt>pval</dt>
<dd><p>The p-value for rejecting the NH.</p></dd>


<dt>Plots</dt>
<dd><p>If argument plots = TRUE, a <span class="pkg">ggplot</span> object
   containing empirical operating characteristics
   corresponding to specified FOM. For example, if <code>FOM</code> =
   <code>"Wilcoxon"</code> an ROC plot object
   is produced where reader 1 is CAD. If an LROC FOM is selected, an LROC
   plot is displayed.</p></dd>


</dl><p>If <code>method = "2T-RRRC"</code> the return value is a list
   with the following elements:</p>
<dl><dt>fomCAD</dt>
<dd><p>The observed FOM for CAD.</p></dd>


<dt>fomRAD</dt>
<dd><p>The observed FOM array for the readers.</p></dd>


<dt>avgRadFom</dt>
<dd><p>The average FOM of the readers.</p></dd>


<dt>avgDiffFom</dt>
<dd><p>The mean of the difference FOM, RAD - CAD.</p></dd>


<dt>ciDiffFom</dt>
<dd><p>A data frame containing the statistics associated
   with the average difference, RAD - CAD.</p></dd>


<dt>ciAvgRdrEachTrt</dt>
<dd><p>A data frame containing the statistics
   associated with the average FOM in each "modality".</p></dd>


<dt>varR</dt>
<dd><p>The variance of the pure reader term in the OR model.</p></dd>


<dt>varTR</dt>
<dd><p>The variance of the modality-reader term error
   term in the OR model.</p></dd>


<dt>cov1</dt>
<dd><p>The covariance1 of the error term - same reader,
   different treatments.</p></dd>


<dt>cov2</dt>
<dd><p>The covariance2 of the error term  -
   different readers, same modality.</p></dd>


<dt>cov3</dt>
<dd><p>The covariance3 of the error term  - different readers,
   different treatments.</p></dd>


<dt>varError</dt>
<dd><p>The variance of the pure error term in the OR model.</p></dd>


<dt>FStat</dt>
<dd><p>The observed value of the F-statistic.</p></dd>


<dt>ndf</dt>
<dd><p>The numerator degrees of freedom of the F-statistic.</p></dd>


<dt>df</dt>
<dd><p>The denominator degrees of freedom of the F-statistic.</p></dd>


<dt>pval</dt>
<dd><p>The p-value for rejecting the NH.</p></dd>


<dt>Plots</dt>
<dd><p>see above.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>

<ul><li><p><strong>PCL</strong> is the probability of a correct localization.</p></li>
<li><p>The LROC is the plot of PCL (ordinate) vs. FPF.</p></li>
<li><p>For LROC data, FOM = "PCL" means the interpolated PCL value
   at the specified <code>FPFValue</code>.</p></li>
<li><p>For FOM = "ALROC" the trapezoidal area under the LROC
   from FPF = 0 to FPF = <code>FPFValue</code> is used.</p></li>
<li><p>If <code>method = "1T-RRRC"</code> the first <strong>reader</strong> is assumed to be CAD.</p></li>
<li><p>If <code>method = "2T-RRRC"</code> the first <strong>modality</strong> is assumed to be CAD.</p></li>
<li><p>The NH is that the FOM of CAD equals the average of the readers.</p></li>
<li><p>The <code>method = "1T-RRRC"</code> analysis uses an adaptation of the
   single-modality multiple-reader Obuchowski Rockette (OR) model described in a
   paper by Hillis (2007), section 5.3. It is characterized by 3 parameters
   <code>VarR</code>, <code>Var</code> and <code>Cov2</code>, where the latter two are estimated
   using the jackknife.</p></li>
<li><p>For <code>method = "2T-RRRC"</code> the analysis replicates the CAD data as many times as
   necessary so as to form one "modality" of an MRMC pairing, the other
   "modality" being the radiologists. Then standard ORH analysis is applied. The
   method is described in Kooi et al. It gives exactly the same final results
   (F-statistic, ddf and p-value) as <code>"1T-RRRC"</code> but the intermediate quantities
   are meaningless.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Hillis SL (2007) A comparison of denominator degrees of freedom methods
for multiple observer ROC studies, Statistics in Medicine. 26:596-619.</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations,
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL.
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840" class="external-link">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a></p>
<p>Hupse R, Samulski M, Lobbes M, et al (2013) Standalone computer-aided detection compared to radiologists
performance for the detection of mammographic masses, Eur Radiol. 23(1):93-100.</p>
<p>Kooi T, Gubern-Merida A, et al. (2016) A comparison between a deep convolutional
neural network and radiologists for classifying regions of interest in mammography.
Paper presented at: International Workshop on Digital Mammography, Malmo, Sweden.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">ret1M</span> <span class="op">&lt;-</span> <span class="fu">StCadVsRad</span> <span class="op">(</span><span class="va">dataset09</span>, </span></span>
<span class="r-in"><span>FOM <span class="op">=</span> <span class="st">"Wilcoxon"</span>, method <span class="op">=</span> <span class="st">"1T-RRRC"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">StCadVsRad</span><span class="op">(</span><span class="va">datasetCadLroc</span>, </span></span>
<span class="r-in"><span>FOM <span class="op">=</span> <span class="st">"Wilcoxon"</span>, method <span class="op">=</span> <span class="st">"1T-RRFC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fomCAD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8169271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fomRAD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8415625 0.8411979 0.8997396 0.8381250 0.8563542 0.8786979 0.8583854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.7970312 0.8268750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $avgRadFom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8486632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CIAvgRadFom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8258894 0.8714370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $avgDiffFom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.03173611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CIAvgDiffFom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.008962347 0.054509875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $varR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0008777927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Tstat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.213505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.01235909</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">retLroc1M</span> <span class="op">&lt;-</span> <span class="fu">StCadVsRad</span> <span class="op">(</span><span class="va">datasetCadLroc</span>, </span></span>
<span class="r-in"><span>FOM <span class="op">=</span> <span class="st">"PCL"</span>, method <span class="op">=</span> <span class="st">"1T-RRRC"</span>, FPFValue <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## test with fewer readers</span></span></span>
<span class="r-in"><span><span class="va">dataset09a</span> <span class="op">&lt;-</span> <span class="fu"><a href="DfExtractDataset.html">DfExtractDataset</a></span><span class="op">(</span><span class="va">dataset09</span>, rdrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ret1M7</span> <span class="op">&lt;-</span> <span class="fu">StCadVsRad</span> <span class="op">(</span><span class="va">dataset09a</span>, </span></span>
<span class="r-in"><span>FOM <span class="op">=</span> <span class="st">"Wilcoxon"</span>, method <span class="op">=</span> <span class="st">"1T-RRRC"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">datasetCadLroc7</span> <span class="op">&lt;-</span> <span class="fu"><a href="DfExtractDataset.html">DfExtractDataset</a></span><span class="op">(</span><span class="va">datasetCadLroc</span>, rdrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ret1MLroc7</span> <span class="op">&lt;-</span> <span class="fu">StCadVsRad</span> <span class="op">(</span><span class="va">datasetCadLroc7</span>, </span></span>
<span class="r-in"><span>FOM <span class="op">=</span> <span class="st">"PCL"</span>, method <span class="op">=</span> <span class="st">"1T-RRRC"</span>, FPFValue <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## takes longer than 5 sec on OSX</span></span></span>
<span class="r-in"><span><span class="co">## retLroc2M &lt;- StCadVsRad (datasetCadLroc, </span></span></span>
<span class="r-in"><span><span class="co">## FOM = "PCL", method = "2T-RRRC", FPFValue = 0.05)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ret2MLroc7 &lt;- StCadVsRad (datasetCadLroc7, </span></span></span>
<span class="r-in"><span><span class="co">## FOM = "PCL", method = "2T-RRRC", FPFValue = 0.05)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dev Chakraborty, Xuetong Zhai.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

