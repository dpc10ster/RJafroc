<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute the chisquare goodness of fit statistic for ROC fitting model — ChisqrGoodnessOfFit • RJafroc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the chisquare goodness of fit statistic for ROC fitting model — ChisqrGoodnessOfFit"><meta property="og:description" content="Compute the chisquare goodness of fit statistic for specified ROC data fitting model"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RJafroc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute the chisquare goodness of fit statistic for ROC fitting model</h1>

    <div class="hidden name"><code>ChisqrGoodnessOfFit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the chisquare goodness of fit statistic for specified ROC data fitting model</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ChisqrGoodnessOfFit</span><span class="op">(</span><span class="va">fpCounts</span>, <span class="va">tpCounts</span>, <span class="va">parameters</span>, <span class="va">model</span>, <span class="va">lesDistr</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-fpcounts">fpCounts<a class="anchor" aria-label="anchor" href="#arg-fpcounts"></a></dt>
<dd><p>The FP counts table</p></dd>


<dt id="arg-tpcounts">tpCounts<a class="anchor" aria-label="anchor" href="#arg-tpcounts"></a></dt>
<dd><p>The TP counts table</p></dd>


<dt id="arg-parameters">parameters<a class="anchor" aria-label="anchor" href="#arg-parameters"></a></dt>
<dd><p>The parameters of the model including cutoffs, see details</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>The fitting model: "BINORMAL", "CBM" or "RSM</p></dd>


<dt id="arg-lesdistr">lesDistr<a class="anchor" aria-label="anchor" href="#arg-lesdistr"></a></dt>
<dd><p>The lesion distribution matrix; not needed for "BINORMAL"
or "CBM" models. Array [1:maxLL,1:2]. The probability mass function of the
lesion distribution for diseased cases. The first column contains the
actual numbers of lesions per case.
The second column contains the fraction of diseased cases with the number
of lesions specified in the first column.
The second column must sum to unity.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with the following elements:</p>
<dl><dt>chisq</dt>
<dd><p>The chi-square statistic</p></dd>


<dt>pVal</dt>
<dd><p>The p-value of the fit</p></dd>


<dt>df</dt>
<dd><p>The degrees of freedom</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>For model = "BINORMAL" the parameters are c(a,b,zetas).
For model = "CBM" the parameters are c(mu,alpha,zetas).
For model = "RSM" the parameters are c(mu,lambda,nu,zetas).
Due to the sparsity of the data, in most cases the goodness of fit statistic
cannot be calculated as the criterion of at least 5 counts in each
cell (TP and FP) is usually not met. An exception dataset is shown below.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Test with TONY data for which chisqr can be calculated</span></span></span>
<span class="r-in"><span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="DfFroc2Roc.html">DfFroc2Roc</a></span><span class="op">(</span><span class="va">dataset01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitBinormalRoc.html">FitBinormalRoc</a></span><span class="op">(</span><span class="va">ds</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># trt 2 and rdr 3</span></span></span>
<span class="r-in"><span><span class="co">## fitted a,b and zeta parameters from preceding line were used to call the</span></span></span>
<span class="r-in"><span><span class="co">## function as shown below:</span></span></span>
<span class="r-in"><span><span class="va">fpCounts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">119</span>,  <span class="fl">30</span>,   <span class="fl">9</span>,  <span class="fl">19</span>,   <span class="fl">7</span>,   <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tpCounts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>,  <span class="fl">7</span>, <span class="fl">16</span>, <span class="fl">29</span>, <span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gfit</span> <span class="op">=</span> <span class="fu">ChisqrGoodnessOfFit</span><span class="op">(</span><span class="va">fpCounts</span>, <span class="va">tpCounts</span>, </span></span>
<span class="r-in"><span>parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit</span><span class="op">$</span><span class="va">b</span>, <span class="va">fit</span><span class="op">$</span><span class="va">zetas</span><span class="op">)</span>, model<span class="op">=</span><span class="st">"BINORMAL"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dev Chakraborty, Xuetong Zhai.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

