<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit the radiological search model (RSM) to an ROC dataset — FitRsmRoc • RJafroc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit the radiological search model (RSM) to an ROC dataset — FitRsmRoc"><meta property="og:description" content="Fit an RSM-predicted ROC curve to a binned single-modality single-reader ROC dataset"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RJafroc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit the radiological search model (RSM) to an ROC dataset</h1>

    <div class="hidden name"><code>FitRsmRoc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit an RSM-predicted ROC curve to a <strong>binned single-modality single-reader ROC dataset</strong></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FitRsmRoc</span><span class="op">(</span><span class="va">binnedRocData</span>, <span class="va">lesDistr</span>, trt <span class="op">=</span> <span class="fl">1</span>, rdr <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-binnedrocdata">binnedRocData<a class="anchor" aria-label="anchor" href="#arg-binnedrocdata"></a></dt>
<dd><p>A <strong>binned ROC</strong> dataset</p></dd>


<dt id="arg-lesdistr">lesDistr<a class="anchor" aria-label="anchor" href="#arg-lesdistr"></a></dt>
<dd><p>The lesion distribution 1D array.</p></dd>


<dt id="arg-trt">trt<a class="anchor" aria-label="anchor" href="#arg-trt"></a></dt>
<dd><p>The selected modality, default is 1</p></dd>


<dt id="arg-rdr">rdr<a class="anchor" aria-label="anchor" href="#arg-rdr"></a></dt>
<dd><p>The selected reader, default is 1</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with the following elements</p>
<dl><dt>mu</dt>
<dd><p>The mean of the diseased distribution relative
   to the non-diseased one</p></dd>


<dt>lambda</dt>
<dd><p>The Poisson parameter describing the distribution
   of latent NLs per case</p></dd>


<dt>nu</dt>
<dd><p>The binomial success probability describing the distribution
   of latent LLs per diseased case</p></dd>


<dt>zetas</dt>
<dd><p>The RSM cutoffs, zetas or thresholds</p></dd>


<dt>AUC</dt>
<dd><p>The RSM fitted ROC-AUC</p></dd>


<dt>StdAUC</dt>
<dd><p>The standard deviation of AUC</p></dd>


<dt>NLLIni</dt>
<dd><p>The initial value of negative LL</p></dd>


<dt>NLLFin</dt>
<dd><p>The final value of negative LL</p></dd>


<dt>ChisqrFitStats</dt>
<dd><p>The chisquare goodness of fit results</p></dd>


<dt>covMat</dt>
<dd><p>The covariance matrix of the parameters</p></dd>


<dt>fittedPlot</dt>
<dd><p>A <span class="pkg">ggplot2</span> object containing the fitted
   operating characteristic along with the empirical operating points.
   Use <code>print</code> to display the object</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If dataset is FROC, first convert it to ROC, using <code><a href="DfFroc2Roc.html">DfFroc2Roc</a></code>.
   MLE ROC algorithms
   require binned datasets. Use <code><a href="DfBinDataset.html">DfBinDataset</a></code> to perform the
   binning prior to calling
   this function.
   In the RSM: (1) The (random) number of latent NLs per case is Poisson distributed
   with mean parameter lambda, and the corresponding ratings are sampled from
   \(N(0,1)\). The (2) The (random) number of latent LLs per diseased case is
   binomial distributed with success probability nu and trial size equal to
   the number of lesions in the case, and the corresponding ratings are sampled from
   N(\(mu\),1). (3) A latent NL or LL is actually marked if its rating exceeds
   the lowest threshold zeta1. To avoid clutter error bars are only shown for the
   lowest and uppermost operating points. Because of the extra parameter, and the
   requirement to have five counts, the chi-square statistic often cannot be calculated.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Chakraborty DP (2006) A search model and figure of merit for observer data acquired according to the free-response
paradigm. Phys Med Biol 51, 3449-3462.</p>
<p>Chakraborty DP (2006) ROC Curves predicted by a model of visual search. Phys Med Biol 51, 3463–3482.</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations,
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL.
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840" class="external-link">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Test with included ROC data (some bins have zero counts)</span></span></span>
<span class="r-in"><span><span class="va">lesDistr</span> <span class="op">&lt;-</span> <span class="fu"><a href="UtilLesDistr.html">UtilLesDistr</a></span><span class="op">(</span><span class="va">dataset02</span><span class="op">)</span><span class="op">$</span><span class="va">Freq</span></span></span>
<span class="r-in"><span><span class="va">retFit</span> <span class="op">&lt;-</span> <span class="fu">FitRsmRoc</span><span class="op">(</span><span class="va">dataset02</span>, <span class="va">lesDistr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## print(retFit$fittedPlot)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Test with included degenerate ROC data</span></span></span>
<span class="r-in"><span><span class="va">lesDistr</span> <span class="op">&lt;-</span> <span class="fu"><a href="UtilLesDistr.html">UtilLesDistr</a></span><span class="op">(</span><span class="va">datasetDegenerate</span><span class="op">)</span><span class="op">$</span><span class="va">Freq</span></span></span>
<span class="r-in"><span><span class="va">retFit</span> <span class="op">&lt;-</span> <span class="fu">FitRsmRoc</span><span class="op">(</span><span class="va">datasetDegenerate</span>, <span class="va">lesDistr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Test with single interior point data</span></span></span>
<span class="r-in"><span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">binnedRocData</span> <span class="op">&lt;-</span> <span class="fu"><a href="Df2RJafrocDataset.html">Df2RJafrocDataset</a></span><span class="op">(</span><span class="va">fp</span>, <span class="va">tp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lesDistr</span> <span class="op">&lt;-</span> <span class="fu"><a href="UtilLesDistr.html">UtilLesDistr</a></span><span class="op">(</span><span class="va">binnedRocData</span><span class="op">)</span><span class="op">$</span><span class="va">Freq</span></span></span>
<span class="r-in"><span><span class="va">retFit</span> <span class="op">&lt;-</span> <span class="fu">FitRsmRoc</span><span class="op">(</span><span class="va">binnedRocData</span>, <span class="va">lesDistr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Test with two interior data points</span></span></span>
<span class="r-in"><span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">binnedRocData</span> <span class="op">&lt;-</span> <span class="fu"><a href="Df2RJafrocDataset.html">Df2RJafrocDataset</a></span><span class="op">(</span><span class="va">fp</span>, <span class="va">tp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lesDistr</span> <span class="op">&lt;-</span> <span class="fu"><a href="UtilLesDistr.html">UtilLesDistr</a></span><span class="op">(</span><span class="va">binnedRocData</span><span class="op">)</span><span class="op">$</span><span class="va">Freq</span></span></span>
<span class="r-in"><span><span class="va">retFit</span> <span class="op">&lt;-</span> <span class="fu">FitRsmRoc</span><span class="op">(</span><span class="va">binnedRocData</span>, <span class="va">lesDistr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Test with three interior data points</span></span></span>
<span class="r-in"><span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">12</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">binnedRocData</span> <span class="op">&lt;-</span> <span class="fu"><a href="Df2RJafrocDataset.html">Df2RJafrocDataset</a></span><span class="op">(</span><span class="va">fp</span>, <span class="va">tp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lesDistr</span> <span class="op">&lt;-</span> <span class="fu"><a href="UtilLesDistr.html">UtilLesDistr</a></span><span class="op">(</span><span class="va">binnedRocData</span><span class="op">)</span><span class="op">$</span><span class="va">Freq</span></span></span>
<span class="r-in"><span><span class="va">retFit</span> <span class="op">&lt;-</span> <span class="fu">FitRsmRoc</span><span class="op">(</span><span class="va">binnedRocData</span>, <span class="va">lesDistr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## test for TONY data, i = 2 and j = 3 </span></span></span>
<span class="r-in"><span><span class="co">## only case permitting chisqure calculation</span></span></span>
<span class="r-in"><span><span class="va">lesDistr</span> <span class="op">&lt;-</span> <span class="fu"><a href="UtilLesDistr.html">UtilLesDistr</a></span><span class="op">(</span><span class="va">dataset01</span><span class="op">)</span><span class="op">$</span><span class="va">Freq</span></span></span>
<span class="r-in"><span><span class="va">rocData</span> <span class="op">&lt;-</span> <span class="fu"><a href="DfFroc2Roc.html">DfFroc2Roc</a></span><span class="op">(</span><span class="va">dataset01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">retFit</span> <span class="op">&lt;-</span> <span class="fu">FitRsmRoc</span><span class="op">(</span><span class="va">rocData</span>, <span class="va">lesDistr</span>, trt <span class="op">=</span> <span class="fl">2</span>, rdr <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## print(retFit$fittedPlot)</span></span></span>
<span class="r-in"><span><span class="co">## retFit$ChisqrFitStats</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dev Chakraborty, Xuetong Zhai.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

